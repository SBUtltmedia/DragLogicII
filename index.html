<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Natural Deduction Contraption</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/introjs.min.css">
</head>
<body>

    <div id="main-container">
        <div id="simp-popup" class="hidden">
            <p>Extract which side?</p>
            <div class="simp-choices">
                <button id="simp-choice-left"></button>
                <span>or</span>
                <button id="simp-choice-right"></button>
            </div>
        </div>
        <div id="help-icon">?</div>
        <h1 id="game-title" class="text-4xl font-bold text-center text-sky-300 px-4 py-2">Natural Deduction Contraption</h1>

        <div id="wff-construction-area" class="game-section">
            <h2>WFF Constructor</h2>

            <!-- Propositional Logic Accordion -->
            <div id="prop-logic-accordion" class="accordion">
                <div id="prop-logic-header" class="accordion-header" role="button" tabindex="0" aria-expanded="true">
                    Propositional Logic
                </div>
                <div id="prop-logic-content" class="accordion-content">
                    <div class="tool-area">
                        <h3>Drag Variables:</h3>
                        <div class="draggable-var" draggable="true" data-type="prop-variable" data-symbol="P" role="button" aria-grabbed="false">P</div>
                        <div class="draggable-var" draggable="true" data-type="prop-variable" data-symbol="Q" role="button" aria-grabbed="false">Q</div>
                        <div class="draggable-var" draggable="true" data-type="prop-variable" data-symbol="R" role="button" aria-grabbed="false">R</div>
                        <div class="draggable-var" draggable="true" data-type="prop-variable" data-symbol="S" role="button" aria-grabbed="false">S</div>
                    </div>
                    <div class="tool-area">
                        <h3>Drop on Connectives:</h3>
                        <div class="connective-hotspot" data-connective="~" title="Drop ONE formula/var here for NOT" role="region" aria-dropeffect="copy">~</div>
                        <div class="connective-hotspot" data-connective="‚àß" title="Drop TWO formulas/vars here for AND" role="region" aria-dropeffect="copy">‚àß</div>
                        <div class="connective-hotspot" data-connective="‚à®" title="Drop TWO formulas/vars here for OR" role="region" aria-dropeffect="copy">‚à®</div>
                        <div class="connective-hotspot" data-connective="‚Üí" title="Drop TWO formulas/vars here for IMPLIES" role="region" aria-dropeffect="copy">‚Üí</div>
                        <div class="connective-hotspot" data-connective="‚Üî" title="Drop TWO formulas/vars here for IFF" role="region" aria-dropeffect="copy">‚Üî</div>
                        <div class="connective-hotspot" data-connective="‚ñ°" title="Drop ONE formula/var here for NECESSARY" role="region" aria-dropeffect="copy">‚ñ°</div>
                        <div class="connective-hotspot" data-connective="‚óä" title="Drop ONE formula/var here for POSSIBLE" role="region" aria-dropeffect="copy">‚óä</div>
                    </div>
                </div>
            </div>

            <div class="wff-output-header mt-4">
                <h3>WFF Output</h3>
                <div class="flex items-center">
                    <div id="trash-can-drop-area" class="ml-2" title="Drag WFF from tray here to delete" role="region" aria-dropeffect="move">üóëÔ∏è</div>
                </div>
            </div>
            <div id="wff-output-tray" title="Drag WFFs here to construct, or to proof area." role="region" aria-dropeffect="copy move"></div>
        </div>

        <div id="proof-area" class="game-section">
                        <div class="proof-header-controls">
                            <h2>Proof</h2>
                            <div id="system-display"></div>
                        </div>
            <div id="proof-problem-info">
                <!-- Problem headers will be injected here by JS -->
            </div>
            <div id="subproof-goal-display-container" class="mt-2"></div>
            <ol id="proof-lines" role="list"></ol>
            <div id="proof-drop-slot" class="proof-drop-slot hidden"></div>
        </div>

        <div id="rules-and-subproofs-column" class="game-section">
            <div id="subproofs-area">
                <h2>Subproofs</h2>
                <!-- Subproof rules will be dynamically inserted here -->
            </div>
            <div id="inference-rules-area" class="mt-4">
                <h2>Inference Rules</h2>
                <!-- Inference rules will be dynamically inserted here -->
            </div>
        </div>

        <div id="feedback-container">
            <button id="prev-feedback" class="feedback-nav-button" aria-label="Previous Feedback">‚Üê</button>
            <div id="proof-feedback" role="alert" aria-live="assertive"></div>
            <button id="next-feedback" class="feedback-nav-button" aria-label="Next Feedback">‚Üí</button>
        </div>
    </div>

    <div id="win-modal-overlay" class="hidden">
        <div id="win-modal">
            <h2>Problem Solved!</h2>
            <p>You have successfully completed the proof.</p>
            <div class="modal-buttons">
                <button id="modal-next-problem-btn">Next Problem</button>
                <button id="modal-close-btn">Close</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>
        <script type="module" src="./js/main.js"></script>
    <script>
        function resizeLayout() {
            const mainContainer = document.getElementById('main-container');
            const htmlElement = document.documentElement;
            const ASPECT_RATIO = 16 / 9;
            let viewportWidth = window.innerWidth;
            let viewportHeight = window.innerHeight;
            const viewportRatio = viewportWidth / viewportHeight;
            let containerWidth, containerHeight, top, left;
            if (viewportRatio > ASPECT_RATIO) {
                containerHeight = viewportHeight;
                containerWidth = containerHeight * ASPECT_RATIO;
                top = 0;
                left = (viewportWidth - containerWidth) / 2;
            } else {
                containerWidth = viewportWidth;
                containerHeight = containerWidth / ASPECT_RATIO;
                top = (viewportHeight - containerHeight) / 2;
                left = 0;
            }
            mainContainer.style.width = `${containerWidth}px`;
            mainContainer.style.height = `${containerHeight}px`;
            mainContainer.style.top = `${top}px`;
            mainContainer.style.left = `${left}px`;
            const rootFontSize = containerWidth / 100;
            htmlElement.style.fontSize = `${rootFontSize}px`;
        }
        window.addEventListener('load', resizeLayout);
        window.addEventListener('resize', resizeLayout);
    </script>
</body>
</html>